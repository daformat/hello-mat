@use "/styles/lib/mixins";

.media_component {
  --custom-ease: cubic-bezier(0.42, 0, 0.25, 1);
  --radius: 6px;
  --aspect-ratio: 16 / 4;
  display: grid;
  grid-template-areas: "content";

  .media_content_wrapper, .media_collapsed_content {
    grid-area: content;
  }

  .media_content_wrapper {
    aspect-ratio: var(--aspect-ratio);
    border-radius: var(--radius);
    height: 4em;
    overflow: hidden;
    position: relative;
    transform-origin: top left;
    transition: height 0.3s var(--custom-ease), width 0.3s var(--custom-ease), aspect-ratio 0.3s var(--custom-ease), transform 0.3s var(--custom-ease), opacity 0.3s ease-in-out, background-color 0.3s ease-in-out 0.6s;
    width: 16em;

    @include mixins.remove-transition;

    .placeholder {
      --t: translate(-50%, -50%);

      color: var(--color-placeholder-icon);
      left: 50%;
      opacity: 0;
      position: absolute;
      top: 50%;
      transform: var(--t) scale(0);
      transition: opacity 0.1s 0.1s ease-in-out, transform 0.1s 0.1s ease-in-out,
      left 0.2s ease-in-out 0.1s, top 0.2s ease-in-out 0.1s;
      z-index: 1;

      @include mixins.remove-transition;
    }
  }

  .media_content {
    display: inline-flex;
    font-size: 0;
  }

  .media_content {
    //height: var(--media-natural-height);
    transition: opacity 0.3s ease-in-out, transform 0.2s 0.1s ease-in-out;

    @include mixins.remove-transition;
    //width: var(--media-natural-width);

    > div, > img {
      transform-origin: top left;
      transition: transform 0.3s var(--custom-ease);
    }
  }

  &[data-media-loading] {
    .media_content_wrapper {
      background-color: var(--color-empty);
    }

    .media_content {
      opacity: 0;
      transform: scale(0);
    }

    .placeholder {
      --c1: cubic-bezier(0.01, 0.3, 0.58, 1);
      --c2: cubic-bezier(0.25, 0.1, 0.25, 1);
      --animation-bumping-heart-2-transform: scale(1.1);
      --animation-bumping-heart-transform: scale(1.1);

      opacity: 0.5;
      transform: var(--t) scale(0.75);

      > * {
        animation: bumping-heart 1.6s var(--c1) infinite backwards,
        bumping-heart-2 1.6s var(--c2) infinite backwards;

        @include mixins.reduced-motion {
          animation: none;
        }
      }
    }
  }

  &:not([data-media-loading]) {
    .media_content, .media_content_wrapper {
      height: 100%;
      width: 100%;
    }

    .media_content_wrapper {
      min-height: initial;
      min-width: initial;
    }

    &[data-media-responsive="both"] {
      .media_content {
        > div, iframe, img {
          height: 100%;
          width: 100%;
        }
      }
    }

    &[data-media-responsive="horizontal"] {
      .media_content_wrapper {
        height: var(--media-natural-height);
      }

      .media_content {
        > div, iframe, img {
          width: 100%;
        }
      }
    }

    &[data-responsive="vertical"] {
      .media_content {
        > div, iframe, img {
          height: 100%;
        }
      }
    }

    &[data-media-keep-aspect-ratio] {
      --aspect-ratio: var(--media-natural-aspect-ratio);

      .media_content, .media_content_wrapper {
        aspect-ratio: var(--aspect-ratio);

        > div, iframe, img {
          aspect-ratio: var(--aspect-ratio);
        }
      }
    }
  }

  &[data-media-collapsed] {
    .media_content_wrapper {
      aspect-ratio: initial !important;
      height: 0;
      opacity: 0;
      width: 0;

      //.media_content {
      //  aspect-ratio: initial !important;
      //
      //  > div, iframe, img {
      //    aspect-ratio: initial !important;
      //  }
      //
      //  > div, > img {
      //    transform: scale(0);
      //  }
      //}

    }
  }
  // ---------------------------------
  // MediaComponent specific animations
  // ---------------------------------

  @keyframes bumping-heart {
    0% {
      transform: none;
    }

    37.5% {
      transform: var(--animation-bumping-heart-transform);
    }
  }

  @keyframes bumping-heart-2 {
    37.5% {
      transform: var(--animation-bumping-heart-2-transform);
    }

    100% {
      transform: none;
    }
  }

}
